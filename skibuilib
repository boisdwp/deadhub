local UI_Lib = {}

local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- Utility function to create UI elements
local function CreateElement(className, properties)
    local element = Instance.new(className)
    for prop, value in pairs(properties) do
        element[prop] = value
    end
    return element
end

-- Create a basic UI frame with a tab system
function UI_Lib:CreateWindow(title)
    local window = CreateElement("ScreenGui", {
        Parent = PlayerGui,
        ResetOnSpawn = false
    })
    
    local frame = CreateElement("Frame", {
        Parent = window,
        Size = UDim2.new(0, 500, 0, 300),
        Position = UDim2.new(0.5, -250, 0.5, -150),
        BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    })
    
    local titleLabel = CreateElement("TextLabel", {
        Parent = frame,
        Size = UDim2.new(1, 0, 0, 30),
        BackgroundTransparency = 1,
        Text = title,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 20,
        Font = Enum.Font.Gotham
    })
    
    return window, frame
end

-- Create a tab button
function UI_Lib:CreateTabButton(tabContainer, title, callback)
    local button = CreateElement("TextButton", {
        Parent = tabContainer,
        Size = UDim2.new(0, 100, 0, 30),
        BackgroundColor3 = Color3.fromRGB(45, 45, 45),
        Text = title,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.Gotham,
        TextSize = 16
    })

    local UICorner = CreateElement("UICorner", {Parent = button})
    UICorner.CornerRadius = UDim.new(0, 8)

    button.MouseButton1Click:Connect(function()
        callback()
    end)

    return button
end

-- Create the content frame that will show on tab switch
function UI_Lib:CreateTabContent(parent)
    local contentFrame = CreateElement("Frame", {
        Parent = parent,
        Size = UDim2.new(1, 0, 1, -40),
        Position = UDim2.new(0, 0, 0, 40),
        BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    })

    return contentFrame
end

-- Create a button inside a tab's content
function UI_Lib:CreateButton(parent, title, callback)
    local button = CreateElement("TextButton", {
        Parent = parent,
        Size = UDim2.new(0, 180, 0, 40),
        BackgroundColor3 = Color3.fromRGB(50, 150, 50),
        Text = title,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.GothamBold,
        TextSize = 16
    })

    local UICorner = CreateElement("UICorner", {Parent = button})
    UICorner.CornerRadius = UDim.new(0, 8)

    button.MouseButton1Click:Connect(function()
        callback()
    end)

    return button
end

-- Add a close button to the window
function UI_Lib:CreateCloseButton(window)
    local closeButton = CreateElement("TextButton", {
        Parent = window,
        Size = UDim2.new(0, 30, 0, 30),
        Position = UDim2.new(1, -40, 0, -40),
        BackgroundColor3 = Color3.fromRGB(150, 50, 50),
        Text = "X",
        TextColor3 = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.GothamBold,
        TextSize = 20
    })

    local UICorner = CreateElement("UICorner", {Parent = closeButton})
    UICorner.CornerRadius = UDim.new(0, 8)

    closeButton.MouseButton1Click:Connect(function()
        window:Destroy()
    end)
end

-- Create the tabs with a container and contents
function UI_Lib:CreateTabSystem(window, tabs)
    local tabContainer = CreateElement("Frame", {
        Parent = window,
        Size = UDim2.new(0, 100, 1),
        BackgroundColor3 = Color3.fromRGB(30, 30, 30),
        Position = UDim2.new(0, 0, 0, 30)
    })

    local contentContainer = CreateElement("Frame", {
        Parent = window,
        Size = UDim2.new(1, -100, 1, -30),
        Position = UDim2.new(0, 100, 0, 30),
        BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    })

    local currentTabContent

    -- Create buttons for each tab and content sections
    for _, tab in pairs(tabs) do
        local tabButton = UI_Lib:CreateTabButton(tabContainer, tab.title, function()
            -- Switch the content
            if currentTabContent then
                currentTabContent.Visible = false
            end
            currentTabContent = tab.content
            currentTabContent.Visible = true
        end)

        local tabContent = UI_Lib:CreateTabContent(contentContainer)
        tab.content = tabContent
        tabContent.Visible = false
    end
end

return UI_Lib
